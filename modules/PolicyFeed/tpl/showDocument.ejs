<%

var config = require("config");

if (doc.meta)
{
    doc.title = doc.meta.title;
    doc.url = doc.meta.url;
    doc.teises_aktas = doc.meta.teises_aktas;
}

if (!doc.org)
    doc.org = "";

returnVar("title", doc.title);

// breadcrumbs:
//*
var day = doc.published.substr(0, 10);

var breadcrumbs = [
    [ doc._id.substr(0, 10), doc._id.substr(6, 4) ],
    [ doc._id.substr(0, 13), doc._id.substr(11, 2) ],
    [ doc._id.substr(0, 16), doc._id.substr(14, 2) ]
    ];

returnVar("breadcrumbs", breadcrumbs);
//*/

// --- Side --- --- ----------------------------------------------------------

var icons = '<img align="top" src="' + config.FILES_URL + '/KaVeikiaValdzia/';

icons = {
    ext: icons + 'ext.png">',
    search: icons + 'search.png">',
    script: icons + 'script.png">'
    };

function tr_key_value(label, value, print_empty) {
    if (value || print_empty)
        print('<tr><td class="label">', label, ':</td><td>', value, '</td></tr>');
}

function obj_key_value(obj) {
    for (var k in obj)
        tr_key_value(k, obj[k]);
}


// Apie dokumentą:
%>
<table id="document-info">
<thead><tr><th colspan="2">Apie dokumentą:</th></tr></thead>
<tbody><%

    obj_key_value({
        "Įstaiga": doc.organization,
        "Tipas": doc.type,
        "Originalas": '<a href="' + doc.url + '">' + doc.title + '</a>',
        "Publikuotas": doc.published
        });

    var formatai = {
        JSON: config.WEB_URL + doc._id + ".json"
    };

    if (doc.teises_aktas && doc.teises_aktas.word)
        formatai.Word = doc.teises_aktas.word;

    print('<tr><td class="label">Failo formatai:</td><td>');
    for (var fmt in formatai)
        print('<a href="', formatai[fmt], '">', fmt, '</a><br>');


%></tbody><%

// Teisės akto meniu:
if (doc.teises_aktas)
{
    var ta = doc.teises_aktas;
    print('<thead><tr><th colspan="2">Teisės akto informacija:</th></tr></thead>');
    print('<tbody>');

    obj_key_value({
        "Rūšis": ta.rusis,
        "Numeris": '<a href="' + config.WEB_URL + '/docs/search/?q=' + ta.numeris + '">' + ta.numeris + icons.search + '</a>',
        "Statusas": ta.statusas
        });

    if (ta.susije)
        print('<tr><td colspan="2" class="label"><a href="', ta.susije, '">Susiję teisės aktai</a></td></tr>');
}


%>
</table>

<div id="document">
<%=doc.html%>
</strong></em></b></i></u></s></tt></h1></h2></h3></h4></h5></h6></a>
</div>

